# Integration Tests

–≠—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è NeoMovies Mobile App.

## –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

### `torrent_integration_test.dart`
–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ç–æ—Ä—Ä–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∞–ª—å–Ω–æ–π –º–∞–≥–Ω–µ—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–æ–º–µ—Ç—Ä–∞–∂–Ω—ã–π —Ñ–∏–ª—å–º **Sintel** –æ—Ç Blender Foundation.

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∞–ª—å–Ω–æ–π –º–∞–≥–Ω–µ—Ç —Å—Å—ã–ª–∫–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ, –ø–∞—É–∑–∞, –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ—Ä—Ä–µ–Ω—Ç–∞—Ö –∏ —Ñ–∞–π–ª–∞—Ö
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ —Ç–∞–π–º–∞—É—Ç–æ–≤

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- **–§–∏–ª—å–º**: Sintel (2010) - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ—Ä–æ—Ç–∫–æ–º–µ—Ç—Ä–∞–∂–Ω—ã–π —Ñ–∏–ª—å–º –æ—Ç Blender Foundation
- **–õ–∏—Ü–µ–Ω–∑–∏—è**: Creative Commons Attribution 3.0
- **–†–∞–∑–º–µ—Ä**: ~700MB (1080p –≤–µ—Ä—Å–∏—è)
- **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç**: https://durian.blender.org/

### `ci_environment_test.dart`
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ CI/CD pipeline.

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ GitHub Actions –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è Dart/Flutter —Å—Ä–µ–¥—ã
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –õ–æ–∫–∞–ª—å–Ω–æ
```bash
# –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
flutter test test/integration/

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
flutter test test/integration/torrent_integration_test.dart
flutter test test/integration/ci_environment_test.dart
```

### –í GitHub Actions
–¢–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ CI pipeline:
```yaml
- name: Run Integration tests  
  run: flutter test test/integration/ --reporter=expanded
  env:
    CI: true
    GITHUB_ACTIONS: true
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### Mock Platform Channel
–í—Å–µ —Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç mock Android platform channel, –ø–æ—ç—Ç–æ–º—É:
- ‚ùå –†–µ–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ—Ä—Ä–µ–Ω—Ç–æ–≤ –ù–ï –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –≤—Å—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–µ–∑ Android –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç –Ω–∞ –ª—é–±–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ (Linux/macOS/Windows)
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ CI

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–¢–µ—Å—Ç—ã –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- `GITHUB_ACTIONS=true` - –∑–∞–ø—É—Å–∫ –≤ GitHub Actions
- `CI=true` - –∑–∞–ø—É—Å–∫ –≤ –ª—é–±–æ–π CI —Å–∏—Å—Ç–µ–º–µ
- `RUNNER_OS` - –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤ GitHub Actions

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ **–æ—Ç–∫—Ä—ã—Ç—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç** –ø–æ–¥ Creative Commons –ª–∏—Ü–µ–Ω–∑–∏–µ–π
- –ù–∏–∫–∞–∫–∏–µ –∞–≤—Ç–æ—Ä—Å–∫–∏–µ –ø—Ä–∞–≤–∞ –Ω–µ –Ω–∞—Ä—É—à–∞—é—Ç—Å—è
- Mock —Ç–µ—Å—Ç—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

## –ú–∞–≥–Ω–µ—Ç —Å—Å—ã–ª–∫–∞ Sintel

```
magnet:?xt=urn:btih:08ada5a7a6183aae1e09d831df6748d566095a10
&dn=Sintel
&tr=udp://tracker.opentrackr.org:1337
&ws=https://webtorrent.io/torrents/
```

**–ü–æ—á–µ–º—É Sintel?**
- üé¨ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (3D –∞–Ω–∏–º–∞—Ü–∏—è)
- üìú –°–≤–æ–±–æ–¥–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è (Creative Commons)
- üåê –®–∏—Ä–æ–∫–æ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Ç–æ—Ä—Ä–µ–Ω—Ç —Å–µ—Ç—è—Ö
- üß™ –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- üìè –ü–æ–¥—Ö–æ–¥—è—â–∏–π —Ä–∞–∑–º–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–æ–≤ (~700MB)

## Troubleshooting

### –¢–∞–π–º–∞—É—Ç—ã –≤ CI
–ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø—Ä–µ–≤—ã—à–∞—é—Ç –ª–∏–º–∏—Ç—ã –≤—Ä–µ–º–µ–Ω–∏:
```dart
// –£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è CI
final timeout = Platform.environment['CI'] == 'true' 
    ? Duration(seconds: 10) 
    : Duration(seconds: 5);
```

### –°–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏
–í –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö CI —Å—Ä–µ–¥–∞—Ö:
```dart
try {
  // –°–µ—Ç–µ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
} catch (e) {
  // Graceful fallback
  print('Network unavailable in CI: $e');
}
```

### Platform Channel –æ—à–∏–±–∫–∏
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ mock –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω:
```dart
TestDefaultBinaryMessengerBinding.instance.defaultBinaryMessenger
    .setMockMethodCallHandler(
  const MethodChannel('com.neo.neomovies_mobile/torrent'),
  (MethodCall methodCall) async {
    return _handleMethodCall(methodCall);
  },
);
```